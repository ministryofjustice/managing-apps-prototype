{% extends "layouts/dps.html" %}

{% set pageName="Log details" %}
{% set version="latest" %}
{% set phasebanner="yes" %}
{% set bodyClasses = 'dps staff-v1' %}
{% set homeurl="/staff/single-general-app/" %}


{% block content %}

<div class="govuk-grid-row">

  <div class="govuk-grid-column-full">
    <div class="govuk-width-container">

      <a href="javascript:history.go(-1)" class="govuk-back-link">Back</a>

      <span class="govuk-caption-xl">General app</span>
      <h1 class="govuk-heading-xl">Log details</h1>

      <div class="govuk-width-container">

        <div class="govuk-grid-row">
          <div class="govuk-grid-column-one-half">

            <form class="form" action="/staff/single-general-app/applications/log/general-app/check-details">
              
              <h2 class="govuk-heading-s">Type of application</h2>

              <div class="govuk-tabs" data-module="govuk-tabs">
                <h2 class="govuk-tabs__title">
                  Contents
                </h2>
                <ul class="govuk-tabs__list">
                  <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
                    <a class="govuk-tabs__tab" href="#search">
                      Search
                    </a>
                  </li>
                  <li class="govuk-tabs__list-item">
                    <a class="govuk-tabs__tab" href="#manual">
                      Enter manually
                    </a>
                  </li>
                </ul>
                <div class="govuk-tabs__panel" id="search">
                  <div class="govuk-form-group">
                    <label class="govuk-label--s" for="pin_07_title">
                      Application type
                    </label>
                    <div id="app_title-hint" class="govuk-hint">
                      Search for the type of application
                    </div>

                    <div class="autocomplete-wrapper">
                      <select name="pin_07_title" id="pin_07_title">
                        <option value="">Select an application type</option>
                        {% for type, details in data['unstructured'] %}
                        {% for app in details.apps %}
                        <option value="{{ app.app_id }}">{{ app.app_name }}</option>
                        {% endfor %}
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                </div>
                <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="manual">
                  <div class="govuk-form-group">
                    <label class="govuk-label--s " for="pin_07_title">
                      Application title
                    </label>
                    <div id="pin_07_title-hint" class="govuk-hint">
                      Sum up what this application is for
                    </div>
                    <input class="govuk-input" id="pin_07_title" name="pin_07_title" type="text">
                  </div>
                </div>
              </div>


              {% from "govuk/components/character-count/macro.njk" import govukCharacterCount %}

              {{ govukCharacterCount({
              name: "pin_07_detail",
              id: "pin_07_detail",
              maxlength: 1000,
              threshold: 75,
              value: data['pin_07_detail'] ,
              label: {
              text: "Details (optional)",
              classes: "govuk-label--s"
              },
              hint: {
              text: "Add a brief summary, for example, if this person is a Foreign National"
              }
              }) }}

              <div class="govuk-form-group">
                <label class="govuk-label govuk-label--s" for="app_dept">
                  Department
                </label>
                <div id="app_dept-hint" class="govuk-hint">
                  Send this application to:
                </div>
                <select class="govuk-select" id="app_dept" name="pin_07_app_dept">
                  <option value="" disabled selected>Select a department</option>
                  <option value="Activities">Activities</option>
                  <option value="Business Hub">Business Hub</option>
                  <option value="Chaplaincy">Chaplaincy</option>
                  <option value="Education">Education</option>
                  <option value="Healthcare">Healthcare</option>
                  <option value="OMU">OMU</option>
                  <option value="Reception">Reception</option>
                  <option value="Safer Custody">Safer Custody</option>
                  <option value="Visits">Visits</option>
                </select>
              </div>


              <div class="moj-button-action">
                <button type="submit" class="govuk-button" data-module="govuk-button">
                  Continue
                </button>
              </div>

            </form>

          </div>
        </div>
      </div>
    </div>
  </div>

</div> <!-- end main content  -->


{% endblock %}

{% block pageScripts %}
<script>
  var selectEl = document.querySelector('#pin_07_title')
  accessibleAutocomplete.enhanceSelectElement({
    autoselect: true,
    confirmOnBlur: true,
    defaultValue: "",
    minLength: 1,
    selectElement: selectEl,
    displayMenu: 'overlay'
  })
</script>

{% endblock %}